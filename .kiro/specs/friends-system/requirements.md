# Документ требований: Система друзей

## Введение

Данный документ описывает требования к реализации системы друзей в браузерной RPG игре на React. Система позволит игрокам добавлять друзей, выполнять совместные квесты и обмениваться предметами, что добавит социальный аспект в игру.

## Глоссарий

- **Система**: Браузерная RPG игра на React
- **Игрок**: Пользователь, управляющий персонажем в игре
- **Друг**: Другой игрок, добавленный в список друзей
- **Список_друзей**: Коллекция друзей игрока
- **Запрос_дружбы**: Приглашение стать друзьями
- **Совместный_квест**: Квест, выполняемый несколькими игроками вместе
- **Обмен**: Передача предметов между друзьями
- **Статус_друга**: Текущее состояние друга (онлайн, оффлайн, в бою, в путешествии)

## Требования

### Требование 1: Управление друзьями

**Пользовательская история:** Как игрок, я хочу добавлять других игроков в друзья, чтобы взаимодействовать с ними.

#### Критерии приемки

1. THE Система SHALL отображать список всех доступных игроков для добавления в друзья
2. WHEN игрок отправляет запрос дружбы, THEN THE Система SHALL создать запрос и отправить уведомление получателю
3. WHEN игрок получает запрос дружбы, THEN THE Система SHALL отображать запрос с кнопками "Принять" и "Отклонить"
4. WHEN игрок принимает запрос дружбы, THEN THE Система SHALL добавить обоих игроков в списки друзей друг друга
5. THE Система SHALL отображать список друзей с их текущим статусом (онлайн, оффлайн, в бою, в путешествии)
6. THE Система SHALL позволять удалять друзей из списка
7. THE Система SHALL отображать базовую информацию о друге (имя, уровень, класс, аватар)

### Требование 2: Статус и активность друзей

**Пользовательская история:** Как игрок, я хочу видеть, чем занимаются мои друзья, чтобы знать, когда можно с ними взаимодействовать.

#### Критерии приемки

1. THE Система SHALL отображать текущий статус каждого друга (онлайн, оффлайн, в бою, в путешествии, в подземелье)
2. THE Система SHALL обновлять статус друзей в реальном времени
3. WHEN друг повышает уровень, THEN THE Система SHALL показывать уведомление игроку
4. THE Система SHALL отображать последнее время активности для оффлайн друзей
5. THE Система SHALL показывать текущую локацию друга, если он в путешествии
6. THE Система SHALL отображать количество побед в PvP для каждого друга

### Требование 3: Совместные квесты

**Пользовательская история:** Как игрок, я хочу выполнять квесты вместе с друзьями, чтобы получать дополнительные награды и веселиться вместе.

#### Критерии приемки

1. THE Система SHALL отображать список доступных совместных квестов
2. WHEN игрок создает группу для квеста, THEN THE Система SHALL позволять пригласить до 3 друзей
3. WHEN друг получает приглашение в группу, THEN THE Система SHALL отображать уведомление с деталями квеста
4. WHEN все участники группы принимают приглашение, THEN THE Система SHALL активировать совместный квест
5. THE Система SHALL отслеживать прогресс квеста для всех участников группы
6. WHEN группа выполняет совместный квест, THEN THE Система SHALL выдавать бонусные награды (увеличенные на 25% за каждого участника)
7. THE Система SHALL распределять награды между всеми участниками группы
8. IF один из участников покидает группу, THEN THE Система SHALL уведомить остальных и предложить продолжить или отменить квест

### Требование 4: Обмен предметами

**Пользовательская история:** Как игрок, я хочу обмениваться предметами с друзьями, чтобы помогать друг другу и торговать.

#### Критерии приемки

1. THE Система SHALL позволять инициировать обмен с другом, который находится онлайн
2. WHEN игрок инициирует обмен, THEN THE Система SHALL отправить запрос на обмен другу
3. WHEN друг принимает запрос на обмен, THEN THE Система SHALL открыть окно обмена для обоих игроков
4. THE Система SHALL отображать окно обмена с двумя панелями (предметы игрока и предметы друга)
5. THE Система SHALL позволять добавлять предметы и золото в обмен
6. THE Система SHALL требовать подтверждения от обоих игроков перед завершением обмена
7. WHEN оба игрока подтверждают обмен, THEN THE Система SHALL передать предметы и золото между игроками
8. THE Система SHALL логировать все обмены для предотвращения мошенничества
9. THE Система SHALL позволять отменить обмен в любой момент до финального подтверждения

### Требование 5: Подарки и помощь

**Пользовательская история:** Как игрок, я хочу отправлять подарки друзьям и помогать им, чтобы укреплять дружбу.

#### Критерии приемки

1. THE Система SHALL позволять отправлять подарки друзьям (предметы, золото, ресурсы)
2. WHEN игрок отправляет подарок, THEN THE Система SHALL создать уведомление для получателя
3. THE Система SHALL отображать список полученных подарков
4. WHEN игрок принимает подарок, THEN THE Система SHALL добавить предметы в инвентарь
5. THE Система SHALL позволять отправлять энергию друзьям (до 5 энергии в день каждому другу)
6. THE Система SHALL отслеживать количество отправленных подарков и помощи
7. THE Система SHALL предоставлять достижения за помощь друзьям

### Требование 6: Чат с друзьями

**Пользовательская история:** Как игрок, я хочу общаться с друзьями через чат, чтобы координировать действия.

#### Критерии приемки

1. THE Система SHALL предоставлять личный чат с каждым другом
2. WHEN игрок отправляет сообщение, THEN THE Система SHALL доставить его другу в реальном времени
3. THE Система SHALL отображать историю последних 50 сообщений
4. THE Система SHALL показывать индикатор непрочитанных сообщений
5. THE Система SHALL отображать индикатор "печатает", когда друг набирает сообщение
6. THE Система SHALL сохранять историю сообщений в localStorage
7. THE Система SHALL поддерживать отправку эмодзи и быстрых фраз

### Требование 7: Рейтинг друзей

**Пользовательская история:** Как игрок, я хочу видеть достижения моих друзей, чтобы соревноваться с ними.

#### Критерии приемки

1. THE Система SHALL отображать мини-рейтинг среди друзей по уровню
2. THE Система SHALL отображать мини-рейтинг среди друзей по золоту
3. THE Система SHALL отображать мини-рейтинг среди друзей по убийствам
4. THE Система SHALL отображать мини-рейтинг среди друзей по PvP рейтингу
5. THE Система SHALL выделять позицию игрока в рейтинге друзей
6. THE Система SHALL показывать разницу в показателях между игроком и друзьями

### Требование 8: Уведомления о друзьях

**Пользовательская история:** Как игрок, я хочу получать уведомления о действиях друзей, чтобы быть в курсе событий.

#### Критерии приемки

1. WHEN друг заходит в игру, THEN THE Система SHALL показывать уведомление "Друг онлайн"
2. WHEN друг повышает уровень, THEN THE Система SHALL показывать уведомление с новым уровнем
3. WHEN друг получает легендарный предмет, THEN THE Система SHALL показывать уведомление
4. WHEN друг отправляет запрос дружбы, THEN THE Система SHALL показывать уведомление
5. WHEN друг приглашает в группу, THEN THE Система SHALL показывать уведомление
6. WHEN друг отправляет подарок, THEN THE Система SHALL показывать уведомление
7. THE Система SHALL позволять настраивать типы уведомлений о друзьях

### Требование 9: Ограничения и безопасность

**Пользовательская история:** Как игрок, я хочу, чтобы система друзей была безопасной и защищенной от злоупотреблений.

#### Критерии приемки

1. THE Система SHALL ограничивать максимальное количество друзей до 50
2. THE Система SHALL ограничивать количество запросов дружбы до 10 в день
3. THE Система SHALL ограничивать количество обменов до 20 в день
4. THE Система SHALL ограничивать количество подарков до 10 в день
5. THE Система SHALL предотвращать обмен предметами с недавно добавленными друзьями (ограничение 24 часа)
6. THE Система SHALL логировать все подозрительные действия (массовые обмены, передача большого количества золота)
7. THE Система SHALL позволять блокировать игроков

### Требование 10: Интеграция с существующими системами

**Пользовательская история:** Как игрок, я хочу, чтобы система друзей интегрировалась с другими функциями игры.

#### Критерии приемки

1. THE Система SHALL интегрировать друзей с системой гильдий (приоритет приглашения друзей в гильдию)
2. THE Система SHALL интегрировать друзей с PvP ареной (возможность вызвать друга на дуэль)
3. THE Система SHALL интегрировать друзей с системой достижений (достижения за количество друзей, совместные квесты)
4. THE Система SHALL интегрировать друзей с системой подземелий (совместное прохождение подземелий)
5. THE Система SHALL сохранять список друзей в localStorage
6. THE Система SHALL синхронизировать данные друзей при экспорте/импорте сохранения

