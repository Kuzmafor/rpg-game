# –î–æ–∫—É–º–µ–Ω—Ç –¥–∏–∑–∞–π–Ω–∞: –°–∏—Å—Ç–µ–º–∞ –¥—Ä—É–∑–µ–π

## –û–±–∑–æ—Ä

–î–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–∏–∑–∞–π–Ω –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –¥—Ä—É–∑–µ–π –≤ –±—Ä–∞—É–∑–µ—Ä–Ω–æ–π RPG –∏–≥—Ä–µ –Ω–∞ React. –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—Ä—É–∑—å—è–º–∏, —Å–æ–≤–º–µ—Å—Ç–Ω—ã–µ –∫–≤–µ—Å—Ç—ã, –æ–±–º–µ–Ω –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏, —á–∞—Ç –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∏–≥—Ä–æ–≤—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏.

### –¶–µ–ª–∏ –¥–∏–∑–∞–π–Ω–∞

- –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ü–∏–∞–ª—å–Ω—ã–π –∞—Å–ø–µ–∫—Ç –≤ –∏–≥—Ä—É —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –¥—Ä—É–∑–µ–π
- –û–±–µ—Å–ø–µ—á–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –æ–±–º–µ–Ω –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏ –º–µ–∂–¥—É –∏–≥—Ä–æ–∫–∞–º–∏
- –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Å–æ–≤–º–µ—Å—Ç–Ω—ã—Ö –∫–≤–µ—Å—Ç–æ–≤ —Å –±–æ–Ω—É—Å–Ω—ã–º–∏ –Ω–∞–≥—Ä–∞–¥–∞–º–∏
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –¥—Ä—É–∑–µ–π —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ (–≥–∏–ª—å–¥–∏–∏, PvP, –ø–æ–¥–∑–µ–º–µ–ª—å—è)
- –û–±–µ—Å–ø–µ—á–∏—Ç—å –ø—Ä–æ—Å—Ç–æ–π –∏ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –¥—Ä—É–∑—å—è–º–∏

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- React 18+ —Å —Ö—É–∫–∞–º–∏ (useState, useEffect, useRef)
- Tailwind CSS –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏
- Lucide React –¥–ª—è –∏–∫–æ–Ω–æ–∫
- localStorage –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥—Ä—É–∑–µ–π
- –°–∏–º—É–ª—è—Ü–∏—è "–æ–Ω–ª–∞–π–Ω" —Å—Ç–∞—Ç—É—Å–∞ —á–µ—Ä–µ–∑ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –±–æ—Ç–æ–≤-–¥—Ä—É–∑–µ–π

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ –±—Ä–∞—É–∑–µ—Ä–Ω–∞—è –∏–≥—Ä–∞ –±–µ–∑ backend, —Å–∏—Å—Ç–µ–º–∞ –¥—Ä—É–∑–µ–π –±—É–¥–µ—Ç —Å–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑:
1. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è NPC-–¥—Ä—É–∑–µ–π**: –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤ —Å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
2. **–õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥—Ä—É–∑–µ–π –∏ –∏—Å—Ç–æ—Ä–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –≤ localStorage
3. **–°–∏–º—É–ª—è—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –¥–ª—è –¥—Ä—É–∑–µ–π (–ø–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è, –Ω–∞—Ö–æ–¥–∫–∏ –ø—Ä–µ–¥–º–µ—Ç–æ–≤)

### –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –¥—Ä—É–≥–∞

```javascript
interface Friend {
  id: string;
  name: string;
  level: number;
  className: string;
  classId: string;
  avatarId: number;
  status: 'online' | 'offline' | 'in_combat' | 'traveling' | 'in_dungeon';
  lastActive: number;
  location: number;
  stats: {
    totalKills: number;
    pvpRating: number;
    gold: number;
    questsCompleted: number;
  };
  friendship: {
    addedAt: number;
    giftsReceived: number;
    giftsSent: number;
    questsCompleted: number;
  };
}
```


### –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä–æ–∫–∞ (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)

```javascript
// –î–æ–±–∞–≤–∏—Ç—å –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –º–æ–¥–µ–ª–∏ Player:
{
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è ...
  
  // –ù–û–í–û–ï: –î—Ä—É–∑—å—è
  friends: string[], // –º–∞—Å—Å–∏–≤ ID –¥—Ä—É–∑–µ–π
  friendRequests: Array<{
    id: string,
    from: string,
    timestamp: number
  }>,
  sentRequests: string[], // ID –∏–≥—Ä–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–º –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –∑–∞–ø—Ä–æ—Å—ã
  blockedPlayers: string[],
  
  // –ù–û–í–û–ï: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥—Ä—É–∑–µ–π
  friendStats: {
    totalFriends: number,
    giftsReceived: number,
    giftsSent: number,
    coopQuestsCompleted: number,
    tradesCompleted: number
  },
  
  // –ù–û–í–û–ï: –ß–∞—Ç
  chatHistory: Record<string, Array<{
    id: string,
    from: string,
    message: string,
    timestamp: number,
    read: boolean
  }>>,
  
  // –ù–û–í–û–ï: –ê–∫—Ç–∏–≤–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
  activeParty: {
    questId: number,
    members: string[],
    progress: number
  } | null,
  
  activeTrade: {
    partnerId: string,
    myItems: number[],
    myGold: number,
    partnerItems: number[],
    partnerGold: number,
    myConfirmed: boolean,
    partnerConfirmed: boolean
  } | null
}
```

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è NPC-–¥—Ä—É–∑–µ–π

#### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏–º–µ–Ω –∏ –∫–ª–∞—Å—Å–æ–≤

```javascript
const FRIEND_NAMES = [
  '–ê—Ä—Ç—É—Ä', '–ú–µ—Ä–ª–∏–Ω', '–õ–∞–Ω—Å–µ–ª–æ—Ç', '–ì–≤–∏–Ω–µ–≤—Ä–∞', '–ú–æ—Ä–≥–∞–Ω–∞',
  '–ü–µ—Ä—Å–∏–≤–∞–ª—å', '–ì–∞–ª–∞—Ö–∞–¥', '–¢—Ä–∏—Å—Ç–∞–Ω', '–ò–∑–æ–ª—å–¥–∞', '–ë–µ–¥–∏–≤–µ—Ä',
  '–ö–µ–π', '–ì–∞—Ä–µ—Ç', '–ì–∞–≤–µ–π–Ω', '–≠–ª–µ–π–Ω', '–í–∏–≤–∏–∞–Ω–∞',
  '–£—Ç–µ—Ä', '–ò–≥—Ä–µ–π–Ω–∞', '–ú–æ–¥—Ä–µ–¥', '–ê–≥—Ä–∞–≤–µ–π–Ω', '–ë–æ—Ä—Å'
];

const generateFriend = (playerId) => {
  const id = `friend_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  const name = FRIEND_NAMES[getRandomInt(0, FRIEND_NAMES.length - 1)];
  const classData = PLAYER_CLASSES[getRandomInt(0, PLAYER_CLASSES.length - 1)];
  const level = getRandomInt(1, 50);
  
  return {
    id,
    name,
    level,
    className: classData.name,
    classId: classData.id,
    avatarId: getRandomInt(1, 15),
    status: Math.random() > 0.3 ? 'online' : 'offline',
    lastActive: Date.now() - getRandomInt(0, 86400000), // –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
    location: getRandomInt(1, 8),
    stats: {
      totalKills: getRandomInt(level * 5, level * 20),
      pvpRating: getRandomInt(800, 2000),
      gold: getRandomInt(level * 100, level * 500),
      questsCompleted: getRandomInt(level, level * 3)
    },
    friendship: {
      addedAt: Date.now(),
      giftsReceived: 0,
      giftsSent: 0,
      questsCompleted: 0
    }
  };
};
```


### 2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç FriendsScreen

–ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥—Ä—É–∑—å—è–º–∏ —Å –≤–∫–ª–∞–¥–∫–∞–º–∏:

```javascript
const FriendsScreen = ({ player, setPlayer }) => {
  const [activeTab, setActiveTab] = useState('list'); // list, requests, search, chat
  const [selectedFriend, setSelectedFriend] = useState(null);
  
  return (
    <div>
      {/* –í–∫–ª–∞–¥–∫–∏ */}
      <div className="flex gap-2 mb-4">
        <Button onClick={() => setActiveTab('list')}>–î—Ä—É–∑—å—è ({player.friends.length})</Button>
        <Button onClick={() => setActiveTab('requests')}>–ó–∞–ø—Ä–æ—Å—ã ({player.friendRequests.length})</Button>
        <Button onClick={() => setActiveTab('search')}>–ù–∞–π—Ç–∏ –¥—Ä—É–∑–µ–π</Button>
        <Button onClick={() => setActiveTab('chat')}>–ß–∞—Ç</Button>
      </div>
      
      {/* –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ */}
      {activeTab === 'list' && <FriendsList />}
      {activeTab === 'requests' && <FriendRequests />}
      {activeTab === 'search' && <SearchFriends />}
      {activeTab === 'chat' && <FriendChat />}
    </div>
  );
};
```

#### –ü–æ–¥–∫–æ–º–ø–æ–Ω–µ–Ω—Ç: –°–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π

```javascript
const FriendsList = ({ player, friends, onSelectFriend }) => {
  return (
    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
      {friends.map(friend => (
        <Card key={friend.id} className="hover:scale-105 transition-transform cursor-pointer">
          <div className="flex items-center gap-4">
            {/* –ê–≤–∞—Ç–∞—Ä */}
            <div className={`w-16 h-16 rounded-full ${AVATARS_DB.find(a => a.id === friend.avatarId)?.color} flex items-center justify-center`}>
              <Icon size={32} />
            </div>
            
            {/* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */}
            <div className="flex-1">
              <div className="flex items-center gap-2">
                <h3 className="font-bold">{friend.name}</h3>
                <StatusBadge status={friend.status} />
              </div>
              <p className="text-sm text-slate-400">
                {friend.className} ‚Ä¢ –£—Ä–æ–≤–µ–Ω—å {friend.level}
              </p>
              <p className="text-xs text-slate-500">
                {friend.status === 'offline' 
                  ? `–ë—ã–ª(–∞) ${formatTimeAgo(friend.lastActive)}`
                  : `–í –ª–æ–∫–∞—Ü–∏–∏: ${LOCATIONS.find(l => l.id === friend.location)?.name}`
                }
              </p>
            </div>
            
            {/* –î–µ–π—Å—Ç–≤–∏—è */}
            <div className="flex flex-col gap-2">
              <Button size="sm" onClick={() => onSelectFriend(friend)}>
                <MessageCircle size={16} /> –ß–∞—Ç
              </Button>
              <Button size="sm" variant="secondary" onClick={() => inviteToParty(friend)}>
                <Users size={16} /> –ì—Ä—É–ø–ø–∞
              </Button>
            </div>
          </div>
        </Card>
      ))}
    </div>
  );
};
```


### 3. –°–∏—Å—Ç–µ–º–∞ —Å–æ–≤–º–µ—Å—Ç–Ω—ã—Ö –∫–≤–µ—Å—Ç–æ–≤

#### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Å–æ–≤–º–µ—Å—Ç–Ω—ã—Ö –∫–≤–µ—Å—Ç–æ–≤

```javascript
const COOP_QUESTS = [
  {
    id: 1,
    name: '–û—Ö–æ—Ç–∞ –Ω–∞ –î—Ä–∞–∫–æ–Ω–∞',
    description: '–ü–æ–±–µ–¥–∏—Ç–µ –î—Ä–µ–≤–Ω–µ–≥–æ –î—Ä–∞–∫–æ–Ω–∞ –≤–º–µ—Å—Ç–µ —Å –¥—Ä—É–∑—å—è–º–∏',
    minPlayers: 2,
    maxPlayers: 4,
    requirements: { minLevel: 20 },
    objectives: [
      { type: 'kill', target: '–î—Ä–µ–≤–Ω–∏–π –î—Ä–∞–∫–æ–Ω', count: 1 }
    ],
    rewards: {
      gold: 2000,
      exp: 1000,
      items: [{ id: 16, name: '–î—Ä–∞–∫–æ–Ω–∏–π –∫–ª—ã–∫' }]
    },
    bonusPerPlayer: 0.25 // +25% –∑–∞ –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞
  },
  {
    id: 2,
    name: '–ó–∞—á–∏—Å—Ç–∫–∞ –ü–æ–¥–∑–µ–º–µ–ª—å—è',
    description: '–ü—Ä–æ–π–¥–∏—Ç–µ –ø–æ–¥–∑–µ–º–µ–ª—å–µ "–ó–∞–±—ã—Ç—ã–µ –ö–∞—Ç–∞–∫–æ–º–±—ã" –≤–º–µ—Å—Ç–µ',
    minPlayers: 2,
    maxPlayers: 3,
    requirements: { minLevel: 10 },
    objectives: [
      { type: 'dungeon', dungeonId: 1, floors: 5 }
    ],
    rewards: {
      gold: 1000,
      exp: 500,
      items: [{ id: 25, name: '–ë–æ–ª—å—à–æ–µ –∑–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è' }]
    },
    bonusPerPlayer: 0.25
  },
  {
    id: 3,
    name: '–°–±–æ—Ä –†–µ—Å—É—Ä—Å–æ–≤',
    description: '–°–æ–±–µ—Ä–∏—Ç–µ —Ä–µ–¥–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã –≤ –æ–ø–∞—Å–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏—è—Ö',
    minPlayers: 2,
    maxPlayers: 4,
    requirements: { minLevel: 15 },
    objectives: [
      { type: 'collect', resourceId: 'dragon_scale', count: 5 },
      { type: 'collect', resourceId: 'mithril_ore', count: 10 }
    ],
    rewards: {
      gold: 1500,
      exp: 750
    },
    bonusPerPlayer: 0.25
  }
];
```

#### –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥—Ä—É–ø–ø–æ–π

```javascript
const createParty = (player, questId, invitedFriends) => {
  const quest = COOP_QUESTS.find(q => q.id === questId);
  
  if (!quest) return { success: false, error: '–ö–≤–µ—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω' };
  if (player.level < quest.requirements.minLevel) {
    return { success: false, error: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å' };
  }
  if (invitedFriends.length < quest.minPlayers - 1) {
    return { success: false, error: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤' };
  }
  if (invitedFriends.length > quest.maxPlayers - 1) {
    return { success: false, error: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤' };
  }
  
  const party = {
    questId,
    leader: player.id,
    members: [player.id, ...invitedFriends.map(f => f.id)],
    status: 'pending', // pending, active, completed
    progress: 0,
    createdAt: Date.now()
  };
  
  // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –¥—Ä—É–∑—å—è–º
  invitedFriends.forEach(friend => {
    sendPartyInvite(friend.id, party);
  });
  
  return { success: true, party };
};

const completeCoopQuest = (player, party) => {
  const quest = COOP_QUESTS.find(q => q.id === party.questId);
  const memberCount = party.members.length;
  const bonus = 1 + (quest.bonusPerPlayer * (memberCount - 1));
  
  const rewards = {
    gold: Math.floor(quest.rewards.gold * bonus),
    exp: Math.floor(quest.rewards.exp * bonus),
    items: quest.rewards.items || []
  };
  
  // –í—ã–¥–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—ã –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º
  party.members.forEach(memberId => {
    giveRewards(memberId, rewards);
  });
  
  // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
  player.friendStats.coopQuestsCompleted += 1;
  
  addNotification(`–°–æ–≤–º–µ—Å—Ç–Ω—ã–π –∫–≤–µ—Å—Ç "${quest.name}" –≤—ã–ø–æ–ª–Ω–µ–Ω! –ë–æ–Ω—É—Å: +${Math.floor((bonus - 1) * 100)}%`, 'success');
  
  return rewards;
};
```


### 4. –°–∏—Å—Ç–µ–º–∞ –æ–±–º–µ–Ω–∞ –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç TradeWindow

```javascript
const TradeWindow = ({ player, partner, onClose, onComplete }) => {
  const [myOffer, setMyOffer] = useState({ items: [], gold: 0 });
  const [partnerOffer, setPartnerOffer] = useState({ items: [], gold: 0 });
  const [myConfirmed, setMyConfirmed] = useState(false);
  const [partnerConfirmed, setPartnerConfirmed] = useState(false);
  
  const addItemToTrade = (item) => {
    if (myOffer.items.length >= 10) {
      addNotification('–ú–∞–∫—Å–∏–º—É–º 10 –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –≤ –æ–±–º–µ–Ω–µ', 'warning');
      return;
    }
    setMyOffer(prev => ({
      ...prev,
      items: [...prev.items, item]
    }));
    setMyConfirmed(false);
  };
  
  const confirmTrade = () => {
    setMyConfirmed(true);
    
    // –°–∏–º—É–ª—è—Ü–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞ (–¥–ª—è NPC)
    setTimeout(() => {
      setPartnerConfirmed(true);
    }, 1000);
  };
  
  useEffect(() => {
    if (myConfirmed && partnerConfirmed) {
      executeTrade();
    }
  }, [myConfirmed, partnerConfirmed]);
  
  const executeTrade = () => {
    // –ü—Ä–æ–≤–µ—Ä–∫–∏
    if (player.gold < myOffer.gold) {
      addNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–æ–ª–æ—Ç–∞', 'error');
      return;
    }
    
    // –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ–±–º–µ–Ω
    const newPlayer = { ...player };
    
    // –£–¥–∞–ª–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã –∏–≥—Ä–æ–∫–∞
    myOffer.items.forEach(item => {
      const index = newPlayer.inventory.findIndex(i => i.id === item.id);
      if (index !== -1) {
        newPlayer.inventory.splice(index, 1);
      }
    });
    
    // –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã –ø–∞—Ä—Ç–Ω–µ—Ä–∞
    partnerOffer.items.forEach(item => {
      newPlayer.inventory.push(item);
    });
    
    // –û–±–º–µ–Ω –∑–æ–ª–æ—Ç–æ–º
    newPlayer.gold = newPlayer.gold - myOffer.gold + partnerOffer.gold;
    
    // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    newPlayer.friendStats.tradesCompleted += 1;
    
    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    console.log('Trade completed:', {
      with: partner.name,
      gave: myOffer,
      received: partnerOffer,
      timestamp: Date.now()
    });
    
    addNotification(`–û–±–º–µ–Ω —Å ${partner.name} –∑–∞–≤–µ—Ä—à–µ–Ω!`, 'success');
    onComplete(newPlayer);
  };
  
  return (
    <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
      <Card className="w-full max-w-4xl">
        <div className="flex justify-between items-center mb-4">
          <h2 className="text-xl font-bold">–û–±–º–µ–Ω —Å {partner.name}</h2>
          <Button variant="danger" onClick={onClose}><X size={20} /></Button>
        </div>
        
        <div className="grid grid-cols-2 gap-4">
          {/* –í–∞—à–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ */}
          <div>
            <h3 className="font-bold mb-2">–í–∞—à–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</h3>
            <div className="space-y-2">
              {myOffer.items.map((item, idx) => (
                <div key={idx} className="flex items-center gap-2 p-2 bg-slate-700 rounded">
                  <span>{item.name}</span>
                  <Button size="sm" variant="danger" onClick={() => removeItem(idx)}>
                    <X size={14} />
                  </Button>
                </div>
              ))}
              <div className="flex items-center gap-2">
                <Coins size={16} />
                <input
                  type="number"
                  value={myOffer.gold}
                  onChange={(e) => setMyOffer(prev => ({ ...prev, gold: parseInt(e.target.value) || 0 }))}
                  className="bg-slate-700 rounded px-2 py-1 w-full"
                  placeholder="–ó–æ–ª–æ—Ç–æ"
                />
              </div>
            </div>
            
            <div className="mt-4">
              <h4 className="text-sm font-bold mb-2">–í–∞—à –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å</h4>
              <div className="grid grid-cols-3 gap-2 max-h-48 overflow-y-auto">
                {player.inventory.map(item => (
                  <Button
                    key={item.id}
                    size="sm"
                    onClick={() => addItemToTrade(item)}
                    disabled={myConfirmed}
                  >
                    {item.name}
                  </Button>
                ))}
              </div>
            </div>
          </div>
          
          {/* –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ */}
          <div>
            <h3 className="font-bold mb-2">–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ {partner.name}</h3>
            <div className="space-y-2">
              {partnerOffer.items.map((item, idx) => (
                <div key={idx} className="flex items-center gap-2 p-2 bg-slate-700 rounded">
                  <span>{item.name}</span>
                </div>
              ))}
              {partnerOffer.gold > 0 && (
                <div className="flex items-center gap-2 p-2 bg-slate-700 rounded">
                  <Coins size={16} />
                  <span>{partnerOffer.gold} –∑–æ–ª–æ—Ç–∞</span>
                </div>
              )}
            </div>
          </div>
        </div>
        
        <div className="mt-4 flex gap-2">
          <Button
            variant={myConfirmed ? 'success' : 'primary'}
            onClick={confirmTrade}
            disabled={myConfirmed}
            className="flex-1"
          >
            {myConfirmed ? '‚úì –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ' : '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–±–º–µ–Ω'}
          </Button>
          <Button variant="danger" onClick={onClose}>
            –û—Ç–º–µ–Ω–∏—Ç—å
          </Button>
        </div>
        
        {partnerConfirmed && (
          <p className="text-center text-green-400 mt-2">
            {partner.name} –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª(–∞) –æ–±–º–µ–Ω
          </p>
        )}
      </Card>
    </div>
  );
};
```


### 5. –°–∏—Å—Ç–µ–º–∞ —á–∞—Ç–∞

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç FriendChat

```javascript
const FriendChat = ({ player, friend, chatHistory, onSendMessage }) => {
  const [message, setMessage] = useState('');
  const chatEndRef = useRef(null);
  
  const messages = chatHistory[friend.id] || [];
  
  useEffect(() => {
    chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  }, [messages]);
  
  const sendMessage = () => {
    if (!message.trim()) return;
    
    const newMessage = {
      id: Date.now().toString(),
      from: player.id,
      message: message.trim(),
      timestamp: Date.now(),
      read: false
    };
    
    onSendMessage(friend.id, newMessage);
    setMessage('');
    
    // –°–∏–º—É–ª—è—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –¥—Ä—É–≥–∞ (–¥–ª—è NPC)
    setTimeout(() => {
      const responses = [
        '–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?',
        '–î–∞–≤–∞–π —Å—Ö–æ–¥–∏–º –≤ –ø–æ–¥–∑–µ–º–µ–ª—å–µ?',
        '–£ –º–µ–Ω—è –µ—Å—Ç—å –æ—Ç–ª–∏—á–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç –¥–ª—è –æ–±–º–µ–Ω–∞!',
        '–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–º–æ—â—å!',
        '–ü–æ–π–¥–µ–º –Ω–∞ —Å–æ–≤–º–µ—Å—Ç–Ω—ã–π –∫–≤–µ—Å—Ç?'
      ];
      const response = {
        id: (Date.now() + 1).toString(),
        from: friend.id,
        message: responses[getRandomInt(0, responses.length - 1)],
        timestamp: Date.now() + 1000,
        read: false
      };
      onSendMessage(friend.id, response);
    }, 2000);
  };
  
  return (
    <div className="flex flex-col h-[600px]">
      {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */}
      <div className="bg-slate-800 p-4 border-b border-slate-700">
        <div className="flex items-center gap-3">
          <div className={`w-10 h-10 rounded-full ${AVATARS_DB.find(a => a.id === friend.avatarId)?.color} flex items-center justify-center`}>
            <Icon size={20} />
          </div>
          <div>
            <h3 className="font-bold">{friend.name}</h3>
            <p className="text-xs text-slate-400">
              {friend.status === 'online' ? 'üü¢ –û–Ω–ª–∞–π–Ω' : '‚ö´ –û—Ñ—Ñ–ª–∞–π–Ω'}
            </p>
          </div>
        </div>
      </div>
      
      {/* –°–æ–æ–±—â–µ–Ω–∏—è */}
      <div className="flex-1 overflow-y-auto p-4 space-y-3">
        {messages.map(msg => (
          <div
            key={msg.id}
            className={`flex ${msg.from === player.id ? 'justify-end' : 'justify-start'}`}
          >
            <div
              className={`max-w-[70%] p-3 rounded-lg ${
                msg.from === player.id
                  ? 'bg-blue-600 text-white'
                  : 'bg-slate-700 text-slate-100'
              }`}
            >
              <p>{msg.message}</p>
              <p className="text-xs opacity-70 mt-1">
                {new Date(msg.timestamp).toLocaleTimeString()}
              </p>
            </div>
          </div>
        ))}
        <div ref={chatEndRef} />
      </div>
      
      {/* –í–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è */}
      <div className="bg-slate-800 p-4 border-t border-slate-700">
        <div className="flex gap-2">
          <input
            type="text"
            value={message}
            onChange={(e) => setMessage(e.target.value)}
            onKeyPress={(e) => e.key === 'Enter' && sendMessage()}
            placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
            className="flex-1 bg-slate-700 rounded-lg px-4 py-2 text-white"
          />
          <Button onClick={sendMessage}>
            <Send size={20} />
          </Button>
        </div>
        
        {/* –ë—ã—Å—Ç—Ä—ã–µ —Ñ—Ä–∞–∑—ã */}
        <div className="flex gap-2 mt-2">
          <Button size="sm" variant="secondary" onClick={() => setMessage('–ü—Ä–∏–≤–µ—Ç!')}>
            üëã –ü—Ä–∏–≤–µ—Ç
          </Button>
          <Button size="sm" variant="secondary" onClick={() => setMessage('–ü–æ–π–¥–µ–º –≤ –≥—Ä—É–ø–ø—É?')}>
            üë• –ì—Ä—É–ø–ø–∞
          </Button>
          <Button size="sm" variant="secondary" onClick={() => setMessage('–°–ø–∞—Å–∏–±–æ!')}>
            üôè –°–ø–∞—Å–∏–±–æ
          </Button>
        </div>
      </div>
    </div>
  );
};
```


### 6. –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–∞—Ä–∫–æ–≤

#### –§—É–Ω–∫—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–¥–∞—Ä–∫–æ–≤

```javascript
const sendGift = (player, friendId, gift) => {
  // –ü—Ä–æ–≤–µ—Ä–∫–∏
  if (player.friendStats.giftsSent >= 10) {
    return { success: false, error: '–î–æ—Å—Ç–∏–≥–Ω—É—Ç –¥–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç –ø–æ–¥–∞—Ä–∫–æ–≤ (10)' };
  }
  
  // –¢–∏–ø—ã –ø–æ–¥–∞—Ä–∫–æ–≤
  const giftTypes = {
    energy: { name: '–≠–Ω–µ—Ä–≥–∏—è', value: 5, icon: Zap },
    gold: { name: '–ó–æ–ª–æ—Ç–æ', value: 100, icon: Coins },
    item: { name: '–ü—Ä–µ–¥–º–µ—Ç', value: gift.item, icon: Gift }
  };
  
  const giftData = giftTypes[gift.type];
  
  // –£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –∏–≥—Ä–æ–∫–∞
  if (gift.type === 'gold') {
    if (player.gold < gift.value) {
      return { success: false, error: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–æ–ª–æ—Ç–∞' };
    }
    player.gold -= gift.value;
  } else if (gift.type === 'item') {
    const itemIndex = player.inventory.findIndex(i => i.id === gift.item.id);
    if (itemIndex === -1) {
      return { success: false, error: '–ü—Ä–µ–¥–º–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω' };
    }
    player.inventory.splice(itemIndex, 1);
  }
  
  // –°–æ–∑–¥–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –¥—Ä—É–≥–∞
  const notification = {
    id: Date.now().toString(),
    type: 'gift',
    from: player.name,
    gift: giftData,
    timestamp: Date.now()
  };
  
  // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
  player.friendStats.giftsSent += 1;
  
  addNotification(`–ü–æ–¥–∞—Ä–æ–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω ${getFriendName(friendId)}!`, 'success');
  
  return { success: true, player };
};

const receiveGift = (player, gift) => {
  // –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∞—Ä–æ–∫
  if (gift.type === 'energy') {
    player.energy = Math.min(player.maxEnergy, player.energy + gift.value);
    addNotification(`–ü–æ–ª—É—á–µ–Ω–æ: +${gift.value} —ç–Ω–µ—Ä–≥–∏–∏ –æ—Ç ${gift.from}`, 'success');
  } else if (gift.type === 'gold') {
    player.gold += gift.value;
    addNotification(`–ü–æ–ª—É—á–µ–Ω–æ: +${gift.value} –∑–æ–ª–æ—Ç–∞ –æ—Ç ${gift.from}`, 'success');
  } else if (gift.type === 'item') {
    player.inventory.push(gift.value);
    addNotification(`–ü–æ–ª—É—á–µ–Ω –ø—Ä–µ–¥–º–µ—Ç: ${gift.value.name} –æ—Ç ${gift.from}`, 'success');
  }
  
  // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
  player.friendStats.giftsReceived += 1;
  
  return player;
};
```

### 7. –†–µ–π—Ç–∏–Ω–≥ –¥—Ä—É–∑–µ–π

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç FriendsLeaderboard

```javascript
const FriendsLeaderboard = ({ player, friends }) => {
  const [category, setCategory] = useState('level'); // level, gold, kills, pvp
  
  const sortedFriends = useMemo(() => {
    const allPlayers = [
      { ...player, isPlayer: true },
      ...friends.map(f => ({ ...f, isPlayer: false }))
    ];
    
    return allPlayers.sort((a, b) => {
      switch (category) {
        case 'level':
          return b.level - a.level;
        case 'gold':
          return b.gold - a.gold;
        case 'kills':
          return b.stats.totalKills - a.stats.totalKills;
        case 'pvp':
          return b.stats.pvpRating - a.stats.pvpRating;
        default:
          return 0;
      }
    });
  }, [player, friends, category]);
  
  return (
    <Card title="–†–µ–π—Ç–∏–Ω–≥ –¥—Ä—É–∑–µ–π" icon={Trophy}>
      {/* –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ */}
      <div className="flex gap-2 mb-4">
        <Button
          variant={category === 'level' ? 'primary' : 'secondary'}
          onClick={() => setCategory('level')}
        >
          –£—Ä–æ–≤–µ–Ω—å
        </Button>
        <Button
          variant={category === 'gold' ? 'primary' : 'secondary'}
          onClick={() => setCategory('gold')}
        >
          –ó–æ–ª–æ—Ç–æ
        </Button>
        <Button
          variant={category === 'kills' ? 'primary' : 'secondary'}
          onClick={() => setCategory('kills')}
        >
          –£–±–∏–π—Å—Ç–≤–∞
        </Button>
        <Button
          variant={category === 'pvp' ? 'primary' : 'secondary'}
          onClick={() => setCategory('pvp')}
        >
          PvP
        </Button>
      </div>
      
      {/* –°–ø–∏—Å–æ–∫ */}
      <div className="space-y-2">
        {sortedFriends.map((p, index) => (
          <div
            key={p.id}
            className={`flex items-center gap-3 p-3 rounded-lg ${
              p.isPlayer ? 'bg-blue-900/30 border-2 border-blue-500' : 'bg-slate-700'
            }`}
          >
            {/* –ü–æ–∑–∏—Ü–∏—è */}
            <div className="w-8 text-center font-bold">
              {index === 0 && 'ü•á'}
              {index === 1 && 'ü•à'}
              {index === 2 && 'ü•â'}
              {index > 2 && `#${index + 1}`}
            </div>
            
            {/* –ê–≤–∞—Ç–∞—Ä */}
            <div className={`w-10 h-10 rounded-full ${AVATARS_DB.find(a => a.id === p.avatarId)?.color} flex items-center justify-center`}>
              <Icon size={20} />
            </div>
            
            {/* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */}
            <div className="flex-1">
              <p className="font-bold">{p.isPlayer ? `${p.name} (–í—ã)` : p.name}</p>
              <p className="text-sm text-slate-400">{p.className} ‚Ä¢ –£—Ä. {p.level}</p>
            </div>
            
            {/* –ó–Ω–∞—á–µ–Ω–∏–µ */}
            <div className="text-right">
              <p className="font-bold text-lg">
                {category === 'level' && p.level}
                {category === 'gold' && `${p.gold} üí∞`}
                {category === 'kills' && p.stats.totalKills}
                {category === 'pvp' && p.stats.pvpRating}
              </p>
            </div>
          </div>
        ))}
      </div>
    </Card>
  );
};
```


## –°–≤–æ–π—Å—Ç–≤–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏

### –°–≤–æ–π—Å—Ç–≤–æ 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥—Ä—É–≥–∞ —Å–æ–∑–¥–∞–µ—Ç –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—é—é —Å–≤—è–∑—å

*–î–ª—è –ª—é–±–æ–≥–æ* –∏–≥—Ä–æ–∫–∞ A –∏ –∏–≥—Ä–æ–∫–∞ B, –∫–æ–≥–¥–∞ A –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –¥—Ä—É–∂–±—ã –∏ B –ø—Ä–∏–Ω–∏–º–∞–µ—Ç, –æ–±–∞ –∏–≥—Ä–æ–∫–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Å–ø–∏—Å–∫–∞—Ö –¥—Ä—É–∑–µ–π –¥—Ä—É–≥ –¥—Ä—É–≥–∞.

**Validates: Requirements 1.4**

### –°–≤–æ–π—Å—Ç–≤–æ 2: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥—Ä—É–∑–µ–π

*–î–ª—è –ª—é–±–æ–≥–æ* –∏–≥—Ä–æ–∫–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥—Ä—É–∑–µ–π –Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–µ–≤—ã—à–∞—Ç—å 50.

**Validates: Requirements 9.1**

### –°–≤–æ–π—Å—Ç–≤–æ 3: –°–æ–≤–º–µ—Å—Ç–Ω—ã–π –∫–≤–µ—Å—Ç —Ç—Ä–µ–±—É–µ—Ç –º–∏–Ω–∏–º—É–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

*–î–ª—è –ª—é–±–æ–≥–æ* —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –∫–≤–µ—Å—Ç–∞ Q —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ N, –≥—Ä—É–ø–ø–∞ –Ω–µ –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å –∫–≤–µ—Å—Ç, –µ—Å–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –º–µ–Ω—å—à–µ N.

**Validates: Requirements 3.2**

### –°–≤–æ–π—Å—Ç–≤–æ 4: –ë–æ–Ω—É—Å—ã —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –∫–≤–µ—Å—Ç–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω—ã —É—á–∞—Å—Ç–Ω–∏–∫–∞–º

*–î–ª—è –ª—é–±–æ–≥–æ* —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –∫–≤–µ—Å—Ç–∞ —Å –±–æ–Ω—É—Å–æ–º B –∑–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞, –Ω–∞–≥—Ä–∞–¥—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–º–Ω–æ–∂–µ–Ω—ã –Ω–∞ (1 + B * (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ - 1)).

**Validates: Requirements 3.6**

### –°–≤–æ–π—Å—Ç–≤–æ 5: –û–±–º–µ–Ω —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–±–µ–∏—Ö —Å—Ç–æ—Ä–æ–Ω

*–î–ª—è –ª—é–±–æ–≥–æ* –æ–±–º–µ–Ω–∞ –º–µ–∂–¥—É –∏–≥—Ä–æ–∫–∞–º–∏ A –∏ B, –ø—Ä–µ–¥–º–µ—Ç—ã –∏ –∑–æ–ª–æ—Ç–æ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω—ã, –ø–æ–∫–∞ –æ–±–∞ –∏–≥—Ä–æ–∫–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–¥—è—Ç –æ–±–º–µ–Ω.

**Validates: Requirements 4.6**

### –°–≤–æ–π—Å—Ç–≤–æ 6: –û–±–º–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤

*–î–ª—è –ª—é–±–æ–≥–æ* –æ–±–º–µ–Ω–∞, —Å—É–º–º–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ —É –æ–±–æ–∏—Ö –∏–≥—Ä–æ–∫–æ–≤ –¥–æ –∏ –ø–æ—Å–ª–µ –æ–±–º–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π.

**Validates: Requirements 4.7**

### –°–≤–æ–π—Å—Ç–≤–æ 7: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ–±–º–µ–Ω–æ–≤ –≤ –¥–µ–Ω—å

*–î–ª—è –ª—é–±–æ–≥–æ* –∏–≥—Ä–æ–∫–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–º–µ–Ω–æ–≤ –≤ –¥–µ–Ω—å –Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–µ–≤—ã—à–∞—Ç—å 20.

**Validates: Requirements 9.3**

### –°–≤–æ–π—Å—Ç–≤–æ 8: –ó–∞–¥–µ—Ä–∂–∫–∞ –æ–±–º–µ–Ω–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –¥—Ä—É–∑–µ–π

*–î–ª—è –ª—é–±–æ–≥–æ* –¥—Ä—É–≥–∞, –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –º–µ–Ω–µ–µ 24 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥, –æ–±–º–µ–Ω –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.

**Validates: Requirements 9.5**

### –°–≤–æ–π—Å—Ç–≤–æ 9: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–¥–∞—Ä–∫–æ–≤ –≤ –¥–µ–Ω—å

*–î–ª—è –ª—é–±–æ–≥–æ* –∏–≥—Ä–æ–∫–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø–æ–¥–∞—Ä–∫–æ–≤ –≤ –¥–µ–Ω—å –Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–µ–≤—ã—à–∞—Ç—å 10.

**Validates: Requirements 9.4**

### –°–≤–æ–π—Å—Ç–≤–æ 10: –°–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏

*–î–ª—è –ª—é–±–æ–≥–æ* –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è, –æ–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞.

**Validates: Requirements 6.6**

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–ª—è –∫–≤–µ—Å—Ç–∞

```javascript
const startCoopQuest = (player, questId, party) => {
  const quest = COOP_QUESTS.find(q => q.id === questId);
  
  if (party.members.length < quest.minPlayers) {
    addNotification(`–î–ª—è —ç—Ç–æ–≥–æ –∫–≤–µ—Å—Ç–∞ –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º ${quest.minPlayers} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤`, 'error');
    return false;
  }
  
  // ... –Ω–∞—á–∞—Ç—å –∫–≤–µ—Å—Ç
};
```

### –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –¥—Ä—É–∑–µ–π

```javascript
const sendFriendRequest = (player, targetId) => {
  if (player.friends.length >= 50) {
    addNotification('–î–æ—Å—Ç–∏–≥–Ω—É—Ç –º–∞–∫—Å–∏–º—É–º –¥—Ä—É–∑–µ–π (50)', 'error');
    return false;
  }
  
  if (player.sentRequests.length >= 10) {
    addNotification('–î–æ—Å—Ç–∏–≥–Ω—É—Ç –¥–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –¥—Ä—É–∂–±—ã (10)', 'error');
    return false;
  }
  
  // ... –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å
};
```

### –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –æ–±–º–µ–Ω–∞

```javascript
const initiateTrade = (player, friendId) => {
  const friend = getFriend(friendId);
  
  if (friend.status !== 'online') {
    addNotification('–î—Ä—É–≥ –Ω–µ –≤ —Å–µ—Ç–∏', 'error');
    return false;
  }
  
  const friendshipAge = Date.now() - friend.friendship.addedAt;
  if (friendshipAge < 86400000) { // 24 —á–∞—Å–∞
    addNotification('–û–±–º–µ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –¥—Ä—É–∑—å—è', 'error');
    return false;
  }
  
  if (player.friendStats.tradesCompleted >= 20) {
    addNotification('–î–æ—Å—Ç–∏–≥–Ω—É—Ç –¥–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç –æ–±–º–µ–Ω–æ–≤ (20)', 'error');
    return false;
  }
  
  // ... –Ω–∞—á–∞—Ç—å –æ–±–º–µ–Ω
};
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≥–∏–ª—å–¥–∏—è–º–∏

```javascript
// –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –¥—Ä—É–∑–µ–π –≤ –≥–∏–ª—å–¥–∏—é
const inviteToGuild = (player, targetId) => {
  const isFriend = player.friends.includes(targetId);
  
  if (isFriend) {
    addNotification('–î—Ä—É–≥ –ø–æ–ª—É—á–∏—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –≥–∏–ª—å–¥–∏—é', 'info');
  }
  
  // ... –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
};
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å PvP

```javascript
// –î—Ä—É–∂–µ—Å–∫–∏–π –ø–æ–µ–¥–∏–Ω–æ–∫
const challengeFriend = (player, friendId) => {
  const friend = getFriend(friendId);
  
  if (friend.status !== 'online') {
    addNotification('–î—Ä—É–≥ –Ω–µ –≤ —Å–µ—Ç–∏', 'error');
    return false;
  }
  
  // –°–æ–∑–¥–∞—Ç—å PvP –º–∞—Ç—á –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞
  const match = {
    type: 'friendly',
    opponent: friend,
    noRatingLoss: true
  };
  
  startPvPMatch(player, match);
};
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–æ–¥–∑–µ–º–µ–ª—å—è–º–∏

```javascript
// –°–æ–≤–º–µ—Å—Ç–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –ø–æ–¥–∑–µ–º–µ–ª–∏–π
const enterDungeonWithParty = (player, dungeonId, party) => {
  const dungeon = DUNGEONS.find(d => d.id === dungeonId);
  
  // –ë–æ–Ω—É—Å –∑–∞ –≥—Ä—É–ø–ø—É: -10% —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞ –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞
  const difficultyReduction = 0.1 * (party.members.length - 1);
  
  const modifiedDungeon = {
    ...dungeon,
    enemyPower: dungeon.enemyPower * (1 - difficultyReduction)
  };
  
  addNotification(`–°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–∑–µ–º–µ–ª—å—è —Å–Ω–∏–∂–µ–Ω–∞ –Ω–∞ ${Math.floor(difficultyReduction * 100)}%`, 'info');
  
  enterDungeon(player, modifiedDungeon);
};
```

## –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Unit-—Ç–µ—Å—Ç—ã

- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –¥—Ä—É–∑–µ–π
- –û—Ç–ø—Ä–∞–≤–∫–∞ –∏ –ø—Ä–∏–Ω—è—Ç–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥—Ä—É–∂–±—ã
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–æ–≤–º–µ—Å—Ç–Ω—ã—Ö –∫–≤–µ—Å—Ç–æ–≤
- –ò–Ω–∏—Ü–∏–∞—Ü–∏—è –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–±–º–µ–Ω–∞
- –û—Ç–ø—Ä–∞–≤–∫–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥–∞—Ä–∫–æ–≤
- –û—Ç–ø—Ä–∞–≤–∫–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

### Property-—Ç–µ—Å—Ç—ã

- –°–≤–æ–π—Å—Ç–≤–æ 1-10 (—Å–º. –≤—ã—à–µ)
- –ö–∞–∂–¥–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–∫—Ä—ã—Ç–æ property-based —Ç–µ—Å—Ç–æ–º —Å –º–∏–Ω–∏–º—É–º 100 –∏—Ç–µ—Ä–∞—Ü–∏—è–º–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

- –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –¥—Ä—É–∂–±—ã (–∑–∞–ø—Ä–æ—Å ‚Üí –ø—Ä–∏–Ω—è—Ç–∏–µ ‚Üí –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ)
- –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –∫–≤–µ—Å—Ç–∞ (—Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã ‚Üí –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ ‚Üí –Ω–∞–≥—Ä–∞–¥—ã)
- –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ–±–º–µ–Ω–∞ (–∏–Ω–∏—Ü–∏–∞—Ü–∏—è ‚Üí –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ ‚Üí –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ)

